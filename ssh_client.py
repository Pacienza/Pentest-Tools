import paramiko  # Lib que manipula SSH

host = "127.0.0.1"  # IP/Hostname do servidor SSH
user = "kali"  # User de autenticação SSH
passwd = "kali"  # Senha SSH


# Cria um cliente SSH
client = paramiko.SSHClient()

# Define a politica de adição automatica de chaves pra hosts desconhecidos
"""
Define a política de chaves de host para adicionar automaticamente
chaves de hosts desconhecidos ('AutoAddPolicy').
"""
client.set_missing_host_key_policy(paramiko.AutoAddPolicy())


# Conecta ao server SSH com as credenciais fornecidas
client.connect(host, username=user, password=passwd)


# While loop pra enviar o comando SSH sem fechar conexão

"""
Usa input("Comando: ") para capturar um comando do usuário.
Executa o comando no servidor SSH usando client.exec_command().
Lê a saída padrão (stdout) do comando e imprime linha por linha.
Lê a saída de erro (stderr) do comando e imprime se houver erros.

"""
while True:

    # Lê o comando
    stdin, stdout, stderr = client.exec_command(input("Comando: "))

    # Lê e imprime o output do comando executado
    for line in stdout.readlines():
        print(line.strip())

    # imprime o output dos erros, caso tenha erro
    erros = stderr.readlines()
    if erros:
        print(erros)
